import Tile from"./tile.min.js";export default class Grid{constructor(t,i,s,e){this.tiles=[],this.enabled=!0,this.selectedTile=null,this.count=i;let h=this.count*this.count,l=s,c=e;for(let i=0;i<h;i++){let e=new Tile(t,l,c);this.tiles.push(e),(i+1)%this.count==0?(l=s,c+=t):l+=t}}click(t,i,s){this.enabled&&this.tiles.forEach((e,h)=>{e.positionX<=t&&t<e.positionX+e.size&&e.positionY<=i&&i<e.positionY+e.size&&this.markAvailable(h,2,s)})}markAvailable(t,i,s){let e=[];t-i*this.count>=0&&this.checkAvailable(t-this.count,t-i*this.count,-this.count)&&e.push(t-i*this.count),t%this.count-i>=0&&this.checkAvailable(t-1,t-i,-1)&&e.push(t-i),t%this.count+i<this.count&&this.checkAvailable(t+1,t+i,1)&&e.push(t+i),t+i*this.count<this.count*this.count&&this.checkAvailable(t+this.count,t+i*this.count,this.count)&&e.push(t+i*this.count),e.length&&(e.forEach(t=>{this.tiles[t].click(s,"#a8a","#8a8")}),this.tiles[t].click(s,"#f0f","#0f0"),this.selectedTile=t)}checkAvailable(t,i,s){let e=t;for(;e!=i+s;){if(0==this.tiles[e].isClickable)return!1;e+=s}return!0}animate(t){this.tiles.forEach((i,s)=>{i.animate(t)})}}